<!DOCTYPE html>
<html lang="en">
    <head>
        <title>melonJS</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Custom styles -->
        <link rel="icon" href="/favicon.png">
    <link rel="stylesheet" href="/assets/8999c0a0.6927e5d3.css" />
<link rel="stylesheet" href="/assets/1a12d8c4.3afb37a6.css" /></head>
    <body>
        <header class="astro-I2FXUJMC">
    
    <nav class="astro-I2FXUJMC">
        <ul class="astro-I2FXUJMC">
            <li class="null astro-I2FXUJMC">
                <a href="/#top" class="astro-I2FXUJMC">Home</a>
            </li>
            <li class="astro-I2FXUJMC">
                <a href="https://www.npmjs.com/package/melonjs" class="astro-I2FXUJMC"><img alt="npm" class="inline no-bump astro-I2FXUJMC" src="/img/npm.svg"></a>
            </li>
            <li class="astro-I2FXUJMC"><a href="https://melonjs.github.io/docs/" class="astro-I2FXUJMC">API</a></li>
            <li class="astro-I2FXUJMC">
                <a href="https://github.com/melonjs/melonJS/wiki/made-with-melonJS" class="astro-I2FXUJMC">Gallery</a>
            </li>
            <li class="astro-I2FXUJMC"><a href="https://melonjs.discourse.group" class="astro-I2FXUJMC"><img class="inline astro-I2FXUJMC" src="/img/discourse.svg">Forum</a></li>
            <li class="astro-I2FXUJMC">
                <a href="https://discord.gg/aur7JMk" target="_blank" class="astro-I2FXUJMC"><img class="inline astro-I2FXUJMC" src="/img/discord.svg">Discord
                </a>
            </li>
            <li class="astro-I2FXUJMC">
                <a href="https://github.com/melonjs/melonJS" class="astro-I2FXUJMC"><img class="inline astro-I2FXUJMC" src="/img/github.svg"><span class="astro-I2FXUJMC">GitHub
                    </span>
                </a>
            </li>
        </ul>
    </nav>
</header>
        <main><h1 id="introduction">Introduction</h1><p>This guide will take you through the basic steps required to deploy your existing melonJS game(s) onto the Facebook Instant Games platform, and thus allowing to play it directly through Facebook and Messenger.</p><p><img src="https://user-images.githubusercontent.com/4033090/37810298-370f9d7a-2e8e-11e8-9e9b-1af3ab3f3783.png" alt="20215865_401372756927198_9018771683342811136_n"></p><blockquote>
<p>Note: to ensure the highest compatibility when integrating melonJS with the Facebook API and deploying games on the “Instant-Game” platform, minimum requirements for melonJS is version 5.1.0</p>
</blockquote><p>The whole process relies on 3 simple steps that will only take a few minutes to complete:</p><ol>
<li>Create a new App through your <a href="https://developers.facebook.com/">Facebook Developer account</a> and configure it as an “Instant-game” product</li>
<li>Integrate the Facebook <a href="https://developers.facebook.com/docs/games/instant-games/sdk">Instant Games API</a> with your game</li>
<li>Upload your game on Facebook infrastructure</li>
</ol><p>Once step 3 is done, you are ready to play your game through Messenger!</p><h1 id="1-setting-up-a-new-instant-game">1. Setting up a new Instant-Game</h1><p>At this stage, it is assumed that you already have a Facebook developer account, if not, you can simply go to the following URL and sign up for a new account: <a href="https://developers.facebook.com/">Facebook Developer account</a></p><p>Once logged in your developer account, let’s first <strong>Create a new app ID</strong>, name it, and click on the [Create App ID] button:</p><p><img src="https://user-images.githubusercontent.com/4033090/37807866-97bcd3e2-2e82-11e8-9b88-8b51f3d3c71f.png" alt="picture1"></p><p>Once done, click on settings in the dashboard on the left, and on the right panel choose the “game” category:</p><p><img src="https://user-images.githubusercontent.com/4033090/37807888-bd75a014-2e82-11e8-9fb6-f0a92fbb558e.png" alt="picture1"></p><p>Then choose a Sub-Category fitting with the style of your game (Puzzle here), and finally do not forget to click on [Save Changes]</p><p><img src="https://user-images.githubusercontent.com/4033090/37807900-cd017206-2e82-11e8-94fa-9840e5fa4d50.png" alt="picture1"></p><p>Then back on the dashboard (on the left), click on +add Product, and choose “Instant-Game” from the available choices on the right:</p><p><img src="https://user-images.githubusercontent.com/4033090/37807913-e19e2bd2-2e82-11e8-8ff1-b71a46370e56.png" alt="picture1"></p><p>Finally, the last step is to fill the form that will appear when clicking on “Set Up”:</p><p><img src="https://user-images.githubusercontent.com/4033090/37807928-f6ed4284-2e82-11e8-8a9f-7e4397586bb4.png" alt="picture1"></p><blockquote>
<p>IMPORTANT NOTE: Make sure you choose “Yes” for “use Instant Games”, and also make sure to choose the appropriate Orientation for your game.</p>
</blockquote><p>Once done, scroll down to the bottom of the page and click on save changes, if all done properly you should then see the following message appearing.</p><p>We are not done yet though, as before uploading our game, we then need to integrate the Facebook API into our melonJS game.</p><h1 id="2-instant-game-facebook-api-integration">2. Instant-Game Facebook API Integration</h1><p>The following instructions is based on the <a href="https://developers.facebook.com/docs/games/instant-games/getting-started">getting-started</a> page of the Instant Games online documentation (where you can find further information and also links to the <a href="https://developers.facebook.com/docs/games/instant-games/sdk">SDK</a> documentation)</p><blockquote>
<p>Note : when loading an Instant Game, it will search for a main root file <code>index.html</code>, so you need to make sure to use the same naming, but as well for the
configuration file <code>fbapp-config.json</code>; an example of the latter can be found in the tic-tac-toe example available in the Quickstart section <a href="https://developers.facebook.com/docs/games/instant-games/getting-started/quickstart">here</a>, and should therefore be placed in the root level of your game beside the index.html file.</p>
</blockquote><h2 id="importing">Importing</h2><p>Now that our app is setup, we can start modifying our existing melonJS game. First step being to import the Instant Games SDK.</p><p>Simply modify your root index.html, and add the following script in the melonJS index.html file, for example before the melonJS script, as shown below.</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">&lt;!--</span><span style="color: #C9D1D9"> Canvas placeholder </span><span style="color: #FF7B72">--&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">  &lt;</span><span style="color: #7EE787">div</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">id</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;screen&quot;</span><span style="color: #C9D1D9">&gt;&lt;/</span><span style="color: #7EE787">div</span><span style="color: #C9D1D9">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">&lt;!--</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">ES5</span><span style="color: #FF7B72">-</span><span style="color: #C9D1D9">Shim </span><span style="color: #FF7B72">--&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">  &lt;</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">type</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;text/javascript&quot;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">src</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;lib/es5-shim.min.js&quot;</span><span style="color: #C9D1D9">&gt;&lt;/</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">&lt;!--</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">FB</span><span style="color: #C9D1D9"> instant Gaming </span><span style="color: #FF7B72">--&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">  &lt;</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">src</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;https://connect.facebook.net/en_US/fbinstant.6.1.js&quot;</span><span style="color: #C9D1D9">&gt;&lt;/</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">&lt;!--</span><span style="color: #C9D1D9"> melonJS Library </span><span style="color: #FF7B72">--&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">  &lt;</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">type</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;text/javascript&quot;</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">src</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;lib/melonjs.js&quot;</span><span style="color: #C9D1D9">&gt;&lt;/</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">&lt;!--</span><span style="color: #C9D1D9"> Game Scripts </span><span style="color: #FF7B72">--&gt;</span></span></code></pre><h2 id="initializing">Initializing</h2><p>First thing to do is Initializing the SDK library, through the <code>FBInstant.initializeAsync()</code> function. This should be called before any other SDK functions. In the example below we call the function and then retrieve the player information</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">FBInstant.</span><span style="color: #D2A8FF">initializeAsync</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">then</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">    playerInfo.name </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> FBInstant.player.</span><span style="color: #D2A8FF">getName</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">    playerInfo.photo </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> FBInstant.player.</span><span style="color: #D2A8FF">getPhoto</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">    playerInfo.id </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> FBInstant.player.</span><span style="color: #D2A8FF">getID</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">    playerInfo.locale </span><span style="color: #FF7B72">=</span><span style="color: #C9D1D9"> FBInstant.</span><span style="color: #D2A8FF">getLocale</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">})</span></span></code></pre><p>Back In our melonJS example, this should be inserted, still in <code>index.html</code> file, but this time in the bootstrap <a href="http://melonjs.github.io/melonJS/docs/me.device.html#onReady"><code>me.device.onReady</code></a> function, and in our case we call <code>game.onload()</code> once the promised is solved, as shown below :</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #C9D1D9">  </span><span style="color: #FF7B72">&lt;!--</span><span style="color: #C9D1D9"> Bootstrap </span><span style="color: #FF7B72">--&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">  &lt;</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">type</span><span style="color: #FF7B72">=</span><span style="color: #A5D6FF">&quot;text/javascript&quot;</span><span style="color: #C9D1D9">&gt;</span></span>
<span class="line"><span style="color: #C9D1D9">      me.device.onReady(function onReady() {</span></span>
<span class="line"><span style="color: #C9D1D9">          FBInstant.</span><span style="color: #D2A8FF">initializeAsync</span><span style="color: #C9D1D9">()</span></span>
<span class="line"><span style="color: #C9D1D9">            .</span><span style="color: #D2A8FF">then</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9">() {</span></span>
<span class="line"><span style="color: #C9D1D9">              game.</span><span style="color: #D2A8FF">onload</span><span style="color: #C9D1D9">();</span></span>
<span class="line"><span style="color: #C9D1D9">          });</span></span>
<span class="line"><span style="color: #C9D1D9">      });</span></span>
<span class="line"><span style="color: #C9D1D9">  &lt;/</span><span style="color: #7EE787">script</span><span style="color: #C9D1D9">&gt;</span></span></code></pre><p>Next and final step is to make sure we inform the SDK of the loading progress, and once all assets are loaded, tells the SDK to end loading view and start the game.</p><p>Informing the SDK about the loading process is done through the <code>FBInstant.setLoadingProgress(progress)</code> function.</p><p>As melonJS already has a <a href="http://melonjs.github.io/melonJS/docs/me.event.html#LOADER_PROGRESS">built-in mechanism for such a progess event</a>, it is as simple as connecting both together by simply adding the following code before calling the melonJS <code>preload()</code> function :</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">// notify the facebook API of the loading progress</span></span>
<span class="line"><span style="color: #C9D1D9">me.event.</span><span style="color: #D2A8FF">subscribe</span><span style="color: #C9D1D9">(me.event.</span><span style="color: #79C0FF">LOADER_PROGRESS</span><span style="color: #C9D1D9">, </span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> (</span><span style="color: #FFA657">progress</span><span style="color: #C9D1D9">) {</span></span>
<span class="line"><span style="color: #C9D1D9">    FBInstant.</span><span style="color: #D2A8FF">setLoadingProgress</span><span style="color: #C9D1D9">(</span><span style="color: #79C0FF">Math</span><span style="color: #C9D1D9">.</span><span style="color: #79C0FF">round</span><span style="color: #C9D1D9">(progress </span><span style="color: #FF7B72">*</span><span style="color: #C9D1D9"> </span><span style="color: #79C0FF">100</span><span style="color: #C9D1D9">))</span></span>
<span class="line"><span style="color: #C9D1D9">})</span></span></code></pre><p>Finally to tells the SDK to end the loading view and start a game, all we need is to insert a call for the <code>startGameAsync()</code> function, from within the onload callback, and right before changing (for example) to your title screen :</p><pre class="astro-code" style="background-color: #0d1117; overflow-x: auto;"><code><span class="line"><span style="color: #8B949E">// tells the SDK to end loading view and start the game</span></span>
<span class="line"><span style="color: #C9D1D9">FBInstant.</span><span style="color: #D2A8FF">startGameAsync</span><span style="color: #C9D1D9">().</span><span style="color: #D2A8FF">then</span><span style="color: #C9D1D9">(</span><span style="color: #FF7B72">function</span><span style="color: #C9D1D9"> () {</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// trigger a window resize event to adapt to the given CANVAS</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// since messenger does not give us the correct fullsize CANVAS size</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// unless the startGameAsync promise is</span></span>
<span class="line"><span style="color: #C9D1D9">    me.event.</span><span style="color: #D2A8FF">publish</span><span style="color: #C9D1D9">(me.event.</span><span style="color: #79C0FF">WINDOW_ONRESIZE</span><span style="color: #C9D1D9">)</span></span>
<span class="line"><span style="color: #C9D1D9">    </span><span style="color: #8B949E">// The player is now guaranteed to have already tapped &quot;play&quot;.</span></span>
<span class="line"><span style="color: #C9D1D9">    me.state.</span><span style="color: #D2A8FF">change</span><span style="color: #C9D1D9">(me.state.</span><span style="color: #79C0FF">PLAY</span><span style="color: #C9D1D9">)</span></span>
<span class="line"><span style="color: #C9D1D9">})</span></span></code></pre><blockquote>
<p>Note : two things to be noted (1) it’s sometime useful to force a resize event by adding a call to <code>me.event.publish(me.event.WINDOW_ONRESIZE)</code> within the promise, as messenger sometimes “fails” as returning the correct full canvas size. (2) a better place where to call the <code>startGameAsync()</code> function is probably after the state were changed, as sometimes, the melonJS loading screen (normally hidden by the Facebook loading screen) might still briefly be visible.</p>
</blockquote><p>And we are done, now the only remaining task is to upload your game and play it in messenger!</p><h1 id="3-game-upload-and-testing">3. Game upload and Testing</h1><p>Instant Games content is hosted on Facebook infrastructure, so you don’t need to host the game content on your own or use third-party services. Once the game is ready for testing, package all game files into a single .zip file. Please note that the index.html file should be in the root of this archive and not in any sub-folders.</p><p>To upload the .zip file, click the Canvas Hosting tab in the App Dashboard. From there select “Instant Game” from the dropdown menu and click +Upload Version which will allow you to upload the .zip file to Facebook’s hosting service.</p><p>After that, the build will process the file, which should only take a few seconds. When the state changes to “Standby”, click the ”★” button to push the build to production.</p><p><img src="https://user-images.githubusercontent.com/4033090/37808621-4894c1c2-2e86-11e8-8a70-68b57de2baa9.png" alt="picture1"></p><p>Once uploaded and in production, the game should appear in the Games Tab of Messenger under the “In Development section”.</p><p>More information about testing, publishing, and sharing your Instant Games are available [here] (<a href="https://developers.facebook.com/docs/games/instant-games/test-publish-share">https://developers.facebook.com/docs/games/instant-games/test-publish-share</a>).</p></main>
    </body></html>